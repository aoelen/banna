{% extends 'dashboard/layout.html' %}
{% load static %}

{% block body %}
<h1>Harvest Overview</h1>
 <hr>

 <div class="container-fluid">
     <div class="page-content page-content-popup">
           <div class="row">
               <div class="col-lg-12 col-xs-12 col-sm-12">
                   <div class="portlet light ">
                       <div class="portlet-title">
                           <div class="caption">
                               <i class="icon-share font-yellow"></i>
                               <span>Statistics</span>
                           </div>
                       </div>

                       <div class="portlet-body" id = "total_harvest">
                         <div class="scroller" style="height: 300px;">

                         </div>
                       </div>
                   </div>
               </div>
           </div>

             <div class="clearfix"></div>

             <h2>Harvest Data</h2>

             <div class="row">
                   <div class="col-lg-12 col-xs-12 col-sm-12">
                    <table class="table table-striped">
                      <tr>
                        <th>Farmer Name</th>
                        <th>Yield</th>
                        <th>Bananas Harvested (KG)</th>
                        <th>Trees Harvested</th>
                        <th>Date</th>
                      </tr>
                      {% for harvest in harvests %}
                         <tr>
                             <td> {{ harvest.report_id.farm.farmer.first_name }} {{ harvest.report_id.farm.farmer.last_name }} </td>
                             <td> {{ harvest.yield_number }} </td>
                             <td> {{ harvest.harvested_amount_kg_banana }} </td>
                             <td> Unknown </td>
                             <td> {{ harvest.report_id.month }} {{ harvest.report_id.year }} </td>
                         </tr>
                      {% endfor %}
                    </table>
                   </div>
               </div>
     </div>
 </div>

 <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart']});
            google.charts.setOnLoadCallback(drawChart);

            function drawChart() {
              var data = google.visualization.arrayToDataTable([
                ['Month', 'KG' ],
                {% for month,amount in harvest_per_month.items %}
                ['{{ month }}', {{amount}}],
                {% endfor %}
              ]);

              var options = {
                curveType: 'function',
                vAxis: { gridlines: { count: 6, color: 'white' } },
                legend: { position: 'right' },
                 colors: ['green']
              };

              var chart = new google.visualization.LineChart(document.getElementById('total_harvest'));

              chart.draw(data, options);
            }
       </script>

{% endblock %}
